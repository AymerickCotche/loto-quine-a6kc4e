// schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model User {
  id        String  @default(cuid()) @id
  name      String  @unique
  password  String
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String
  cards     Card[]
}

model Session {
  id       String @default(cuid()) @id
  name     String @unique
  password String
  cards    Card[]
  users    User[]
}

model Number {
  id    String           @default(cuid())  @id
  value String           @unique
  drawn Boolean          @default(false)
  cards NumbersOnCards[]
  draws NumbersOnDraws[]
}

model Card {
  id        String           @default(cuid()) @id
  name      String           @unique
  session   Session          @relation(fields: [sessionId], references: [id])
  sessionId String
  user   User          @relation(fields: [userId], references: [id])
  userId String
  numbers   NumbersOnCards[]
}

model Draw {
  id      String           @default(cuid()) @id
  name    String           @unique
  numbers NumbersOnDraws[]
}

model NumbersOnCards {
  card     Card     @relation(fields: [cardId], references: [id])
  cardId   String
  number   Number   @relation(fields: [numberId], references: [id])
  numberId String

  @@id([cardId, numberId])
}

model NumbersOnDraws {
  draw     Draw     @relation(fields: [drawId], references: [id])
  drawId   String
  number   Number   @relation(fields: [numberId], references: [id])
  numberId String

  @@id([drawId, numberId])
}